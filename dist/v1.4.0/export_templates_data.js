/**
 * Export Templates Data Module - Report Generation Templates
 * Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„ØªØµØ¯ÙŠØ± - Ù‚ÙˆØ§Ù„Ø¨ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
 */

const EXPORT_TEMPLATES = {
    text: {
        name: 'Text Report',
        extension: '.txt',
        mimeType: 'text/plain',
        template: `
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    ØªÙ‚Ø±ÙŠØ± Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³Ù…
                 HISAB NAME ANALYSIS REPORT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ø§Ù„Ø§Ø³Ù…: {{name}}
Ø§Ù„Ù‚ÙŠÙ…Ø©: {{value}}
Ø§Ù„Ø¬Ø°Ø± Ø§Ù„Ø±Ù‚Ù…ÙŠ: {{digitRoot}}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                    Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{{basicAnalysis}}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                    Ø¹Ù„Ù… Ø§Ù„ÙÙ„Ùƒ Ø§Ù„Ø¹Ø±Ø¨ÙŠ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Ø§Ù„Ø¹Ù†ØµØ±: {{element}}
Ø§Ù„ÙƒÙˆÙƒØ¨: {{planet}}
Ø§Ù„Ø¨Ø±Ø¬: {{zodiac}}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                    Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{{islamicAnalysis}}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                    Ø§Ù„ØªÙˆØ§ÙÙ‚ ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{{compatibility}}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© Ø­Ø³Ø§Ø¨
                Generated by Hisaab v{{version}}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`
    },
    json: {
        name: 'JSON Export',
        extension: '.json',
        mimeType: 'application/json',
        structure: {
            metadata: {
                version: '{{version}}',
                generatedAt: '{{timestamp}}',
                generator: 'Hisaab Arabic Numerology Library'
            },
            name: {
                arabic: '{{name}}',
                value: '{{value}}',
                digitRoot: '{{digitRoot}}',
                breakdown: '{{breakdown}}'
            },
            analysis: {
                astrology: '{{astrology}}',
                islamic: '{{islamic}}',
                numerology: '{{numerology}}',
                business: '{{business}}'
            },
            compatibility: '{{compatibility}}',
            recommendations: '{{recommendations}}'
        }
    },
    html: {
        name: 'HTML Report',
        extension: '.html',
        mimeType: 'text/html',
        template: `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙ‚Ø±ÙŠØ± Ø­Ø³Ø§Ø¨ - {{name}}</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Amiri', 'Traditional Arabic', serif;
            background: linear-gradient(135deg, #1a472a 0%, #2d5a3d 50%, #1a472a 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 30px;
            color: #333;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        .header {
            text-align: center;
            border-bottom: 3px solid #1a472a;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #1a472a;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .header .subtitle {
            color: #c9a227;
            font-size: 1.2em;
        }
        .section {
            margin-bottom: 25px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 10px;
            border-right: 4px solid #1a472a;
        }
        .section h2 {
            color: #1a472a;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .value-box {
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #1a472a, #c9a227);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .value-box .value {
            font-size: 4em;
            font-weight: bold;
            color: #fff;
        }
        .value-box .label {
            font-size: 1.5em;
            color: #fff;
            margin-right: 15px;
        }
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .info-item {
            background: #fff;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .info-item .label {
            color: #666;
            font-size: 0.9em;
        }
        .info-item .value {
            color: #1a472a;
            font-size: 1.5em;
            font-weight: bold;
        }
        .breakdown-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .breakdown-table th, .breakdown-table td {
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }
        .breakdown-table th {
            background: #1a472a;
            color: #fff;
        }
        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #1a472a;
            color: #666;
        }
        .print-only { display: none; }
        @media print {
            body { background: #fff; }
            .container { box-shadow: none; }
            .print-only { display: block; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>{{name}}</h1>
            <div class="subtitle">ØªÙ‚Ø±ÙŠØ± Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³Ù…</div>
        </div>
        
        <div class="value-box">
            <span class="label">Ø§Ù„Ù‚ÙŠÙ…Ø©</span>
            <span class="value">{{value}}</span>
        </div>
        
        <div class="section">
            <h2>ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</h2>
            <div class="info-grid">
                <div class="info-item">
                    <div class="label">Ø§Ù„Ø¬Ø°Ø± Ø§Ù„Ø±Ù‚Ù…ÙŠ</div>
                    <div class="value">{{digitRoot}}</div>
                </div>
                <div class="info-item">
                    <div class="label">Ø§Ù„Ø¹Ù†ØµØ±</div>
                    <div class="value">{{element}}</div>
                </div>
                <div class="info-item">
                    <div class="label">Ø§Ù„ÙƒÙˆÙƒØ¨</div>
                    <div class="value">{{planet}}</div>
                </div>
                <div class="info-item">
                    <div class="label">Ø§Ù„Ø¨Ø±Ø¬</div>
                    <div class="value">{{zodiac}}</div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ“ ØªÙØµÙŠÙ„ Ø§Ù„Ø­Ø±ÙˆÙ</h2>
            <table class="breakdown-table">
                <thead>
                    <tr>
                        <th>Ø§Ù„Ø­Ø±Ù</th>
                        <th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th>
                    </tr>
                </thead>
                <tbody>
                    {{breakdownRows}}
                </tbody>
            </table>
        </div>
        
        <div class="section">
            <h2>â˜ªï¸ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠ</h2>
            <div>{{islamicAnalysis}}</div>
        </div>
        
        <div class="section">
            <h2>ğŸ”® Ø§Ù„ØªÙˆØµÙŠØ§Øª</h2>
            <div>{{recommendations}}</div>
        </div>
        
        <div class="footer">
            <p>ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© <strong>Ø­Ø³Ø§Ø¨</strong> - Ù…ÙƒØªØ¨Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</p>
            <p>Ø§Ù„Ø¥ØµØ¯Ø§Ø± {{version}} | {{timestamp}}</p>
        </div>
    </div>
</body>
</html>`
    },
    markdown: {
        name: 'Markdown Report',
        extension: '.md',
        mimeType: 'text/markdown',
        template: `# ØªÙ‚Ø±ÙŠØ± Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³Ù… - {{name}}

## ğŸ“Š Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

| Ø§Ù„Ø³Ù…Ø© | Ø§Ù„Ù‚ÙŠÙ…Ø© |
|-------|--------|
| **Ø§Ù„Ø§Ø³Ù…** | {{name}} |
| **Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ø¯Ø¯ÙŠØ©** | {{value}} |
| **Ø§Ù„Ø¬Ø°Ø± Ø§Ù„Ø±Ù‚Ù…ÙŠ** | {{digitRoot}} |

## ğŸ”¤ ØªÙØµÙŠÙ„ Ø§Ù„Ø­Ø±ÙˆÙ

| Ø§Ù„Ø­Ø±Ù | Ø§Ù„Ù‚ÙŠÙ…Ø© |
|-------|--------|
{{breakdownTable}}

## ğŸŒ™ Ø¹Ù„Ù… Ø§Ù„ÙÙ„Ùƒ Ø§Ù„Ø¹Ø±Ø¨ÙŠ

| Ø§Ù„Ø³Ù…Ø© | Ø§Ù„Ù‚ÙŠÙ…Ø© |
|-------|--------|
| **Ø§Ù„Ø¹Ù†ØµØ±** | {{element}} |
| **Ø§Ù„ÙƒÙˆÙƒØ¨** | {{planet}} |
| **Ø§Ù„Ø¨Ø±Ø¬** | {{zodiac}} |

## â˜ªï¸ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠ

{{islamicAnalysis}}

## ğŸ’¼ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„

{{businessAnalysis}}

## ğŸ”® Ø§Ù„ØªÙˆØµÙŠØ§Øª

{{recommendations}}

---

*ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© **Ø­Ø³Ø§Ø¨** v{{version}}*
*ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: {{timestamp}}*
`
    }
};

const REPORT_SECTIONS = {
    basic: {
        title: { arabic: 'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©', english: 'Basic Information' },
        fields: ['name', 'value', 'digitRoot', 'classification']
    },
    astrology: {
        title: { arabic: 'Ø¹Ù„Ù… Ø§Ù„ÙÙ„Ùƒ Ø§Ù„Ø¹Ø±Ø¨ÙŠ', english: 'Arabic Astrology' },
        fields: ['element', 'planet', 'zodiac', 'favorableDay']
    },
    islamic: {
        title: { arabic: 'Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠ', english: 'Islamic Analysis' },
        fields: ['asmaUlHusnaMatch', 'quranicConnection', 'islamicQualities', 'spiritualGuidance']
    },
    compatibility: {
        title: { arabic: 'Ø§Ù„ØªÙˆØ§ÙÙ‚', english: 'Compatibility' },
        fields: ['partnerHouse', 'compatibilityLevel', 'recommendations']
    },
    business: {
        title: { arabic: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„', english: 'Business Analysis' },
        fields: ['overallRating', 'recommendedIndustries', 'timingGuidance', 'successIndicators']
    },
    numerology: {
        title: { arabic: 'Ø¹Ù„Ù… Ø§Ù„Ø£Ø±Ù‚Ø§Ù…', english: 'Numerology' },
        fields: ['masterNumbers', 'karmicDebt', 'hiddenPotential', 'luckyNumbers']
    }
};

const CLIPBOARD_FORMATS = {
    short: {
        template: '{{name}} = {{value}} (Ø§Ù„Ø¬Ø°Ø±: {{digitRoot}}, Ø§Ù„Ø¹Ù†ØµØ±: {{element}})',
        maxLength: 100
    },
    medium: {
        template: `{{name}} | Ø§Ù„Ù‚ÙŠÙ…Ø©: {{value}} | Ø§Ù„Ø¬Ø°Ø±: {{digitRoot}}
Ø§Ù„Ø¹Ù†ØµØ±: {{element}} | Ø§Ù„ÙƒÙˆÙƒØ¨: {{planet}} | Ø§Ù„Ø¨Ø±Ø¬: {{zodiac}}
{{islamicQualities}}`,
        maxLength: 500
    },
    detailed: {
        template: `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Ø§Ù„Ø§Ø³Ù…: {{name}}
Ø§Ù„Ù‚ÙŠÙ…Ø©: {{value}}
Ø§Ù„Ø¬Ø°Ø± Ø§Ù„Ø±Ù‚Ù…ÙŠ: {{digitRoot}}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Ø§Ù„Ø¹Ù†ØµØ±: {{element}} ({{elementArabic}})
Ø§Ù„ÙƒÙˆÙƒØ¨: {{planet}} ({{planetArabic}})
Ø§Ù„Ø¨Ø±Ø¬: {{zodiac}} ({{zodiacArabic}})
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
{{islamicAnalysis}}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`,
        maxLength: 1000
    }
};

const PDF_PRINT_SETTINGS = {
    pageSettings: {
        format: 'A4',
        orientation: 'portrait',
        margins: {
            top: '20mm',
            bottom: '20mm',
            left: '15mm',
            right: '15mm'
        }
    },
    headerSettings: {
        title: 'ØªÙ‚Ø±ÙŠØ± Ø­Ø³Ø§Ø¨',
        showLogo: true,
        showDate: true
    },
    footerSettings: {
        showPageNumber: true,
        showVersion: true,
        copyrightText: 'Â© Hisaab - Arabic Numerology Library'
    }
};

function generateTextReport(data) {
    const template = EXPORT_TEMPLATES.text.template;
    return template
        .replace(/\{\{name\}\}/g, data.name || '')
        .replace(/\{\{value\}\}/g, data.value || '')
        .replace(/\{\{digitRoot\}\}/g, data.digitRoot || '')
        .replace(/\{\{element\}\}/g, data.element || '')
        .replace(/\{\{planet\}\}/g, data.planet || '')
        .replace(/\{\{zodiac\}\}/g, data.zodiac || '')
        .replace(/\{\{basicAnalysis\}\}/g, data.basicAnalysis || '')
        .replace(/\{\{islamicAnalysis\}\}/g, data.islamicAnalysis || '')
        .replace(/\{\{compatibility\}\}/g, data.compatibility || '')
        .replace(/\{\{version\}\}/g, data.version || '1.4.0');
}

function generateHTMLReport(data) {
    let breakdownRows = '';
    if (data.breakdown && Array.isArray(data.breakdown)) {
        data.breakdown.forEach(item => {
            breakdownRows += `<tr><td>${item.letter}</td><td>${item.value}</td></tr>`;
        });
    }
    
    return EXPORT_TEMPLATES.html.template
        .replace(/\{\{name\}\}/g, data.name || '')
        .replace(/\{\{value\}\}/g, data.value || '')
        .replace(/\{\{digitRoot\}\}/g, data.digitRoot || '')
        .replace(/\{\{element\}\}/g, data.element || '')
        .replace(/\{\{planet\}\}/g, data.planet || '')
        .replace(/\{\{zodiac\}\}/g, data.zodiac || '')
        .replace(/\{\{breakdownRows\}\}/g, breakdownRows)
        .replace(/\{\{islamicAnalysis\}\}/g, data.islamicAnalysis || '')
        .replace(/\{\{recommendations\}\}/g, data.recommendations || '')
        .replace(/\{\{version\}\}/g, data.version || '1.4.0')
        .replace(/\{\{timestamp\}\}/g, new Date().toISOString());
}

function generateJSONExport(data) {
    return JSON.stringify({
        metadata: {
            version: data.version || '1.4.0',
            generatedAt: new Date().toISOString(),
            generator: 'Hisaab Arabic Numerology Library'
        },
        name: {
            arabic: data.name,
            value: data.value,
            digitRoot: data.digitRoot,
            breakdown: data.breakdown
        },
        analysis: {
            astrology: data.astrology,
            islamic: data.islamic,
            numerology: data.numerology,
            business: data.business
        },
        compatibility: data.compatibility,
        recommendations: data.recommendations
    }, null, 2);
}

function generateMarkdownReport(data) {
    let breakdownTable = '';
    if (data.breakdown && Array.isArray(data.breakdown)) {
        data.breakdown.forEach(item => {
            breakdownTable += `| ${item.letter} | ${item.value} |\n`;
        });
    }
    
    return EXPORT_TEMPLATES.markdown.template
        .replace(/\{\{name\}\}/g, data.name || '')
        .replace(/\{\{value\}\}/g, data.value || '')
        .replace(/\{\{digitRoot\}\}/g, data.digitRoot || '')
        .replace(/\{\{element\}\}/g, data.element || '')
        .replace(/\{\{planet\}\}/g, data.planet || '')
        .replace(/\{\{zodiac\}\}/g, data.zodiac || '')
        .replace(/\{\{breakdownTable\}\}/g, breakdownTable)
        .replace(/\{\{islamicAnalysis\}\}/g, data.islamicAnalysis || '')
        .replace(/\{\{businessAnalysis\}\}/g, data.businessAnalysis || '')
        .replace(/\{\{recommendations\}\}/g, data.recommendations || '')
        .replace(/\{\{version\}\}/g, data.version || '1.4.0')
        .replace(/\{\{timestamp\}\}/g, new Date().toISOString());
}

function generateClipboardText(data, format = 'medium') {
    const template = CLIPBOARD_FORMATS[format] || CLIPBOARD_FORMATS.medium;
    return template.template
        .replace(/\{\{name\}\}/g, data.name || '')
        .replace(/\{\{value\}\}/g, data.value || '')
        .replace(/\{\{digitRoot\}\}/g, data.digitRoot || '')
        .replace(/\{\{element\}\}/g, data.element || '')
        .replace(/\{\{elementArabic\}\}/g, data.elementArabic || '')
        .replace(/\{\{planet\}\}/g, data.planet || '')
        .replace(/\{\{planetArabic\}\}/g, data.planetArabic || '')
        .replace(/\{\{zodiac\}\}/g, data.zodiac || '')
        .replace(/\{\{zodiacArabic\}\}/g, data.zodiacArabic || '')
        .replace(/\{\{islamicQualities\}\}/g, data.islamicQualities || '')
        .replace(/\{\{islamicAnalysis\}\}/g, data.islamicAnalysis || '');
}

function getAvailableFormats() {
    return Object.keys(EXPORT_TEMPLATES).map(key => ({
        id: key,
        name: EXPORT_TEMPLATES[key].name,
        extension: EXPORT_TEMPLATES[key].extension,
        mimeType: EXPORT_TEMPLATES[key].mimeType
    }));
}

module.exports = {
    EXPORT_TEMPLATES,
    REPORT_SECTIONS,
    CLIPBOARD_FORMATS,
    PDF_PRINT_SETTINGS,
    generateTextReport,
    generateHTMLReport,
    generateJSONExport,
    generateMarkdownReport,
    generateClipboardText,
    getAvailableFormats
};